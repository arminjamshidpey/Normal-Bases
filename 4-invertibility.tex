\section{Complexity of Arithmetic Operations in the Group Algebra}

The problems we consider in this section are of independent interest:
given an element $\alpha$ in $\F[G]$, for a field $\F$ and a group $G$,
determine whether $\alpha$ is a unit in $\F[G]$. 

Since we are in characteristic zero, Wedderburn's theorem implies the
existence of an $\\F$-algebra isomorphism
$$\varphi: \F[G] \to M_{d_1}(D_1) \times \dots \times M_{d_r}(D_r),$$
where all $D_i$'s are division algebras over $\F$. If we were working
over $\F=\C$, all $D_i$'s would simply be $\C$ itself; then, a natural
solution to test the invertibility of $\alpha$ would be to compute its
Fourier transform $\varphi(\alpha)$ and test whether all its
components $\varphi_1(\alpha) \in M_{d_1}(\C),\dots,\varphi_r(\alpha)
\in M_{d_r}(\C)$ are invertible. This boils down to linear algebra
over $\C$, and takes $O(d_1^\omega + \cdots + d_r^\omega)$ operations.
Since $d_1^2 + \cdots + d_r^2 = |G|$, this is $O(|G|^{\omega/2})$
operations in $\C$.

However, we do not wish to make such an assumption as $\F=\C$. Since we
measure the cost of our algorithms in $\F$-operations, the direct
approach that embeds $\F[G]$ into $\C[G]$ does not make it possible to
obtain a subquadratic cost in general. If for instance $\F=\Q$ and $G$
is cyclic of order $n=2^k$, $\varphi$ is the usual Cooley-Tukey
Fourier transform, but computing it requires we work in a degree $n/2$
extension of $\Q$, whence a quadratic runtime.

On the other hand, the Wedderburn decomposition over $\F$ may not be
trivial to compute. As a result, for the families of groups we have
considered so far, we will work with an 
 $\\F$-algebra isomorphism
$$\psi: \F[G] \to M_{c_1}(R_1) \times \dots \times M_{c_s}(R_s),$$
bla bla bla.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Abelian groups}

\noindent{\bf Decomposing the tensor product of two cyclotomic
  algebras.}  Let $p$ be a prime, fixed throughout this paragraph and
the next one. Then, for $j \ge 0$, let $F_j:=\Phi_{p^j}$ be the
$p^j$-th cyclotomic polynomial, seen as a polynomial in $\F[x]$. Thus
all $F_j$'s are squarefree, but they may not be irreducible.

The key to the following algorithms is the elementary remark below.
Let $c,c'$ be positive integers, with $c \ge c'$, and let $y$ be
another indeterminate over $\F$. Define $\mathbbm{a}:=\F[x]/F_c(x)$,
and let $\bar x$ be the residue class of $x$ in $\A$. Then, in
$\mathbbm{a}[y]$, $F_{c'}(y)$ factors as
$$F_{c'}(y) =\prod_{\substack{1 \le i\le p^{c'}-1\\ \gcd(i,p) =1}}
(y-\rho_i),$$ with $\rho_i:={\bar x}^{i p^{c-c'}}$ for all $i$.  Even
though $\mathbbm{a}$ may not be a field, since all linear factors of
$F_{c'}(y)$ are pairwise coprime, the Chinese Remainder theorem
implies that the algebra
$$\mathbbm{b}:=\F[x,y]/\langle F_c(x), F_{c'}(y)\rangle = \mathbbm{a}[y]/F_{c'}(y)$$
is isomorphic to $\mathbbm{a}^{\varphi(p^{c'})}$, where $\varphi$ is Euler's totient function.
The isomorphism is given by
$$\begin{array}{cccc}
\Theta: & \mathbbm{b} & \to & \mathbbm{a} \times \cdots \times \mathbbm{a} \\
        & P & \mapsto& (P(\bar x,\rho_1),\dots,P(\bar x,\rho_{\varphi(p^{c'})}).
\end{array}$$
In terms of complexity, arithmetic operations $(+,-,\times)$ in $\mathbbm{a}$
can all be done in $\tilde{O}(\varphi(p^c))$ operations in $\F$.
Starting from $\rho_1 \in \mathbbm{a}$, all other roots $\rho_i$ can be
computed in $O(\varphi(p^{c'}))$ operations in $\mathbbm{a}$, that is,
$\tilde{O}(\varphi(p^c) \varphi(p^{c'}))$ operations in $\mathbbm{b}$.  We
rewrite this as $\tilde{O}(\deg(\mathbbm{b}))$, where $\dim(\mathbbm{b}):=\varphi(p^c)
\varphi(p^{c'})$ is the dimension of $\mathbbm{b}$ as an $\F$-vector space.

Applying $\Theta$ and its inverse is done by means of fast evaluation
and interpolation~\cite[Chapter~11]{vzGathen13} in $\tilde{O}(\varphi(p^{c'}))$
operations in $\mathbbm{a}$, that is, $\tilde{O}(\deg(\mathbbm{b}))$ operations in $\F$
(the algorithms do not require that $\mathbbm{a}$ be a field).


\smallskip\noindent{\bf Extension to several cyclotomic algebras.}
Let $p$ and the $F_j$'s be as before, and consider now positive integers
$c_1,\dots,c_t$ and variables $x_1,\dots,x_t$. We define the
$\F$-algebra
$$\A:=\F[x_1,\dots,x_t]/\langle F_{c_1}(x_1), \dots,
F_{c_t}(x_t)\rangle,$$ which we will sometimes write
$\A_{p,c_1,\dots,c_t}$ to make the dependency on $p$ and the $c_i$'s
clear. Up to reordering the $c_i$'s, we can assume that $c_1 \ge c_i$
holds for all $i$, and define as before
$\mathbbm{a}:=\F[x_1]/F_{c_1}(x_1)$.

\begin{lemma}\label{lemma:A}
  There exists an $\F$-algebra isomorphism $\Theta: \A \to
  \mathbbm{a}^{\dim(\A)/\dim(\mathbbm{a})}$. This isomorphism and its
  inverse can be computed in $\tilde{O}(\dim(\A))$ operations in $\F$.
\end{lemma}
\begin{proof}
We proceed iteratively. First, rewrite $\A$ as
$$\A=\mathbbm{a}[x_2,x_3,\dots,x_t]/\langle F_{c_2}(x_2), F_{c_3}(x_3), \dots,
F_{c_t}(x_t)\rangle.$$ 
The isomorphism 
$\theta: \mathbbm{a}[x_2]/F_{c_2}(x_2) \to \mathbbm{a}^{\varphi(p^{c_2})}$
introduced in the previous paragraph extends coordinate-wise
to an isomorphism 
$$\Theta_1: \A \to (\mathbbm{a}[x_3,\dots,x_t]/\langle F_{c_3}(x_3),
\dots, F_{c_t}(x_t)\rangle)^{\varphi(p^{c_2})};$$ $\Theta_1$ and its
inverse can be evaluated in quasi-linear time $\tilde{O}(\dim(\A))$.
We now work in all copies of $\mathbbm{a}[x_3,\dots,x_t]/\langle
F_{c_3}(x_3), \dots, F_{c_t}(x_t)\rangle$ independently, and apply the
procedure above to each of them. Altogether, we have $t-1$ such 
steps to perform, giving us an isomorphism 
$$\Theta = \Theta_{t-1} \circ \cdots \circ \Theta_1:
\A \to
\mathbbm{a}^{\varphi(p^{c_2}) \cdots \varphi(p^{c_t})}.$$
The exponent can be rewritten as $ \dim(\A)/\dim(\mathbbm{a})$, as claimed.
In terms of complexity, all $\Theta_i$'s and their inverses can be computed
in quasi-lienar time $\tilde{O}(\dim(\A))$, and we do $t-1$ of them,
where $t$ is $O(\log(\dim(\A)))$. The proof is complete.
\end{proof}

\noindent{\bf Decomposing certain $p$-group algebras.}
The prime $p$, polynomials $F_j$ and indeterminates $x_1,\dots,x_t$
are as before; we now consider positive integers $b_1 \ge \cdots \ge b_t$,
and the $\F$-algebra
$$
\begin{array}{ccc}
\B&:=&\F[x_1,\dots,x_t]/\langle x_1^{p^{b_1}}-1,\dots,x_t^{p^{b_t}}-1\rangle\\$$
&=& \F[x_1]/\langle x_1^{p^{b_1}}-1 \rangle \otimes \cdots \otimes \F[x_t]/\langle x_t^{p^{b_t}}-1 \rangle;
\end{array}$$
if needed, we will write $\B_{p,b_1,\dots,b_t}$ to make the dependency
on $p$ and the $b_i$'s clear. Note that this is the $\F$-group algebra
of $\Z/p^{b_1}\Z \times \cdots \times \Z/p^{b_t}\Z$.

For $i \le t$, $x_i^{p^{b_i}}-1$ factors as $(x_i-1) F_0(x_i)
F_1(x_i) \cdots F_{b_i-1}(x_i)$. The factors may not be irreducible,
but they are pairwise coprime, so that we have a Chinese Remainder
isomorphism
$$\lambda_i: \F[x_i]/\langle x_i^{p^{b_i}}-1 \rangle \to \F[x_i]/\langle x_i-1\rangle
\times \cdots \times  \F[x_i]/\langle F_{b_i-1}(x_i)\rangle;$$
it can be computed (together with its inverse) 
in $\tilde{O}(p^{b_i})$ operations in $\F$. By distributivity of the tensor
product, 
this gives an $\F$-algebra isomorphism
$$\lambda: \B \to \prod_{c_1=-1}^{b_i-1} \cdots \prod_{c_t=-1}^{b_t-1} \A_{t,c_1,\dots,c_t}$$
which can be computed in $\tilde{O}(\dim(\B))$ operations in $\F$ (together with its inverse).
Composing with the result in Lemma~\ref{lemma:A}, this gives
us an isomorphim
$$\Lambda: \B \to \B':=\prod_{c_1=-1}^{b_i-1} \cdots \prod_{c_t=-1}^{b_t-1}
\mathbbm{a}_{c_1,\dots,c_t}^{D_{c_1,\dots,c_t}},$$ where
$\mathbbm{a}_{c_1,\dots,c_t} = \F[x]/F_{p^c}$, with $c
=\max(c_1,\dots,c_t)$ and $D_{c_1,\dots,c_t} =
\dim(\A_{t,c_1,\dots,c_t})/\dim(\mathbbm{a}_{c_1,\dots,c_t})$.  As
before, $\Lambda$ and its inverse can be computed in quasi-linear time
$\tilde{O}(\dim(\B))$. As for $\B$, we will 
write $\B'_{p,b_1,\dots,b_t}$ if needed (it is well-defined, up to the order of the factors).

\noindent{\bf Main result.}  As in Subsection~\ref{ssec:proj_abelian}, suppose
that $G$ is an abelian group, presented as
$$ \langle g_1, \ldots , g_r: g_{1}^{e_1} = \cdots = g_{r}^{e_r} = 1
\rangle$$ where $ e_i \in \mathbb{N}$ is the order of $g_i$ and $n =
e_1 \cdots e_r$. 

Let us write the elementary divisor decomposition of $G$ as $G = G_1
\times G_s$, where each $G_i$ is of prime power order $p_i^{a_i}$, so
that $n = p_1^{a_1} \cdots p_s^{a_s}$, where $p_1 < \cdots < p_s$ are
primes ($G_i$ is the $p_i$-Sylow subgroup of $G$). Each $G_i$ can
itself be written as a product of cyclic groups, $G_i = G_{i,1} \times
\cdots \times G_{i,t_i}$, where the factor $G_{i,j}$ is cyclic of
order ${p_i}^{b_{i,j}}$, with $b_{i,1} \le \cdots \le b_{i,t_i}$; this
is the invariant factor decomposition of $G_i$, with $b_{i,1} + \cdots
+ b_{i,t_i} = a_i$.

We will henceforth assume that generators
$\gamma_{1,1},\dots,\gamma_{s,t_s}$ of respectively
$G_{1,1},\dots,G_{s,t_s}$ are known, and that elements of $\F[G]$ are
given on the power basis in $\gamma_{1,1},\dots,\gamma_{s,t_s}$. Were
it not case, a brute-force solution would factor each $e_i$ (factoring
$e_i$ takes $o(e_i)$ bit operations on a standard RAM), so as to write
$\langle g_i \rangle$ as a product of cyclic groups of prime power
orders, from which the required decomposition follows.

From the factorization $G = G_1 \times \cdots \times G_s$, we deduce
that the group algebra $\F[G]$ is the tensor product $\F[G_1]
\otimes \cdots \otimes \F[G_s]$ (taken over $\F$). Further, the 
factorization $G_i = G_{i,1} \times \cdots \times G_{i,t_i}$
implies that $\F[G_i]$ is isomorphic, as an $\F$-algebra, to
$$\F[x_{1},\dots,x_{t_i}]/\left \langle x_{1}^{p_i^{b_{1}}}-1,\dots,x_{1}^{p_i^{b_{i,t_i}}}-1\right\rangle
=\B_{p,b_{i,1},\dots,b_{i,t_i}}.$$


Given $\alpha = \sum \alpha_{i_1,\dots,i_r} g_1^{i_1}\cdots
g_r^{i_r}$, its image in $\A$ is simply 
$$A= \sum
\alpha_{i_1,\dots,i_r} x_1^{i_1}\cdots x_r^{i_r}.$$
{\bf todo: apply distributivity tensor product to get an isomorphism
$\F[G]$ to a product of $\B'$'s}







%%% Local Variables:
%%% mode: latex
%%% TeX-master: "NormalBasisCharZero"
%%% End:
